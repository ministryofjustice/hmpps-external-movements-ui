{% from "govuk/components/summary-list/macro.njk" import govukSummaryList %}

{% for period in periods %}
  {% set rows = [] %}
  {% for absence in period.absences %}
    {% set rows = (rows.push({
      key: {
        classes: 'half-width',
        html: absence.startDate | formatDate('cccc d MMMM') if absence.startDate === absence.returnDate else (absence.startDate | formatDate('cccc d MMMM') + ' to <br/>' + absence.returnDate | formatDate('cccc d MMMM'))
      },
      value: {
        html: 'Start time: ' + absence.startTime + '<br/>Return time: ' + absence.returnTime
      }
    }), rows) %}
  {% endfor %}

  {{ govukSummaryList({
    card: {
      title: {
        text: "Week starting " + period.startDate | formatDate('cccc d MMMM yyyy')
      }
    },
    rows: rows if rows.length else [{ key: { text: "No absence entered" } }]
  }) }}
{% endfor %}

  {% switch patternType %}
  {% case 'SHIFT' %}
    {% set changeLink = "enter-shift-pattern" %}
  {% case 'WEEKLY' %}
    {% if user | featureEnabled('INTRA_DAY') %}
      {% set changeLink = "multi-absences-per-day" %}
    {% else %}
      {% set changeLink = "select-days-times-weekly" %}
    {% endif %}
  {% case 'BIWEEKLY' %}
    {% if user | featureEnabled('INTRA_DAY') %}
      {% set changeLink = "multi-absences-per-day" %}
    {% else %}
      {% set changeLink = "select-days-times-biweekly" %}
    {% endif %}
  {% default %}
    {% set changeLink = '' %}
  {% endswitch %}

<p><a class="govuk-link govuk-link--no-visited-state" href="{{ changeLink }}">Go back to change this schedule</a></p>
